<?php
error_reporting(E_ERROR | E_PARSE);
//require("installer.php");

/*
* INFO: This all system needs a public target directory such as http://examplesite.com/mypublic-source
* which contains all the source code that can be fetched & zipped to any server
*/

require("deploy.php");

/* extract */
$src = new ZipArchive(); // create a new instance of your source directory
$zip = new ZipArchive();// create an instance of ZipArchive

if(is_deployed())
{
    $src->open(ROOT_PATH . "/full-fetchable-source/spirit-revision-rev-70.zip"); // zip file to extract
    $src->extractTo(ROOT_PATH); // extract directory
    echo "Fetching source code from server...";

    $target_name = "./spirit-revision_archive.zip"; // set a target name
    $zip->addFromString("README.txt" . '' , "Compressed spirit-revision successfully.\n");
    $zip->addFile('core/hello-world.txt','hello-world.txt');
}else{
    $src->open("core/spirit-revision-rev-70.zip"); // zip file to extract
    $src->extractTo('src'); // extract directory
    echo "Fetching source code from local server...";

    // details to create a zip
    $target_name = "./spirit-revision_archive.zip"; // set a target name
    $zip->addFromString("README.txt" . '' , "Compressed spirit-revision successfully.\n");
    $zip->addFile('core/hello-world.txt','hello-world.txt');
}

//$zip->open($target_name, ZipArchive::CREATE); // create a zip archive

// add files to the archive

// close to avoid leak
$zip->close();
$src->close();
?>
